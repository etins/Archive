Java 的基本理念是“结构不佳的代码不能运行”

### 12.1 概念

C 以及其它早期语言常常具有多种处理模式，这些模式往往建立在约定俗成的基础之上，而不属于语言的一部分。通常会返回某个特殊值或者设置某个标志，并且假定接收者将这个返回值或标志进行检查，以判定是否发生了错误。这样发生了错误就往往会认为是别人的错误，如果的确每次调用的时候都彻底做错误检查，代码会很难读。

解决的办法是，用强制规定的形式来消除错误处理过程中随心所欲的因素。

异常的好处：
1. 当前环境没有足够信息来解决问题，所以就把这个问题提价到一个更高级别的环境中。
2. 降低错误处理代码的复杂度。异常机制使代码的阅读、编写和调试工作更加井井有条。

### 12.2 基本异常

异常情形使指阻止当前方法或作用域执行的问题。把异常情形和普通问题相区分很重要，所谓普通问题是指，当前环境下能够得到足够的信息，总能处理这个错误。对于异常情形，就不能继续下去了，因为在当前环境无法获得必要的信息来解决问题。

异常使得我们可以将每件事当作一个事务来考虑，而异常可以看护这些事务的底线。我们还可以将异常看作一种内建的恢复系统。

### 12.3 捕获异常

```
try {
    // Code that might generate exceeptions
} catch (Type1 id1) {
    // Handle exceptions of Type1
} catch (Type2 id2) {
    // Handle exceptions of Type2
} catch (Type3 id3) {
    // Handle exceptions of Type3
}

终止与恢复

异常处理理论有两种基本模型。Java 支持终止模型。这种模型假设错误非常关键，以至于程序无法返回到异常发生的地方继续执行。

另一种是恢复模型。意思是异常处理程序的工作是修正错误，然后重新尝试调用出问题的方法，并认为第二次可以成功。

操作系统就是支付恢复模型的异常处理，但是：恢复性的处理程序需要了解异常抛出的地点，这势必要包含依赖于抛出位置的非通用性代码。增加了代码编写和维护的困难。
```

### 12.4 创建自定义异常

不必拘泥于 Java 中已有的异常类型。 Java 提供的异常体系不可能遇见所有的错误，可以用自定义异常类来标识程序中可能会遇到的特定问题。

### 12.7 Java 标准异常

Throwable 这个 Java 类被用来标识任何可以作为异常被抛出的类。 Throwable 对象可分为两种类型：Error 用来表示编译时和系统错误；Exception 是可以被抛出的基本类型。

#### 12.7.1 RuntimeException

RuntimeException 是一个特例，对于这种异常类型，编译器不需要异常说明，其输出被报告给了 System.err:

1. 无法预料的错误。比如从你控制范围之外传递进来的 null 引用。
2. 在代码中检查错误。

### 12.8 使用 finall 清理

当要把内存之外的资源恢复到它们的初始状态时，就要用 finally 子句。这种需要清理的资源包括：已经打开的文件或网络链接，在屏幕上画的图形，甚至可以是外部世界的某个开关。

在 reuturn 中也可以使用 finally

### 12.9 异常的限制

当覆盖方法的时候，只能抛出基类方法的异常说明列表里列出的异常。这个限制很有用，因为意味着，当基类使用的代码应用到其它派生类对象的时候，一样能够工作，异常也不例外。

### 12.10 构造器

在构造器中使用异常要格外的小心，对于在构造阶段可能会抛出异常，并且要求清理的类，最安全的方式是使用嵌套 try 子句。

### 12.11 异常匹配

抛出异常的时候，异常处理系统会按照代码的书写顺序找出“最近”的处理程序。找到匹配的程序之后，它就会认为异常得到处理，然后就不再寻找。

查找的时候并不要求抛出的异常同处理程序声明的异常完全匹配。派生类的对象也可以匹配其基类的处理程序。

### 12.12 其他可选方式

异常处理的一个重要原则是“只有你知道如何处理的情况下才捕获异常”。实际上，异常的一个重要目标就是把错误处理的代码同错误发生的地点分离。

避免导致吞食则有害的问题。

### 12.13 异常使用指南

1. 在恰当的级别处理问题（在知道如何处理的情况下才捕获异常）
2. 解决问题并且重新调用
3. 进行少许修补
4. 用别的数据进行计算，以代替方法语句会返回的值
5. 把当前运行环境下能做的事情做完，然后把相同的异常重抛到更高层
6. 把当前运行环境下能做的事情做完，然后把不同的异常重抛到更高层
7. 终止程序
8. 进行简化
9. 让类库和程序更安全 

### 12.14 总结

异常处理的优点之一就是它使得你可以在某处集中精力处理你要解决的问题，而在另一处处理你编写的代码中产生的错误。

Java 坚定地强调所有的错误都以异常形式报告的这一事实，正式它远远超过诸如 C++ 这类语言的长处之一。